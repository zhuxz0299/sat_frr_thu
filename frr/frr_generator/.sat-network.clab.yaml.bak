name: sat-network
mgmt:
  network: my_network
  ipv4-subnet: 192.0.0.0/2
topology:
  nodes:
    GROUND:
      kind: linux
      image: frrouting/frr:v8.2.2
      binds:
        - sat_output/GROUND1/daemons:/etc/frr/daemons
      exec:
        - ip address add 193.200.0.1/2 dev e1
        - ip address add 193.200.0.2/2 dev e2
        - >-
          vtysh -c 'conf t'

          -c 'router ospf'

          -c 'network 192.0.0.0/2 area 0'

          -c 'exit'

          -c 'exit'

          -c 'write'

          -c '!'
    MEO1:
      kind: linux
      image: frrouting/frr:v8.2.2
      binds:
        - sat_output/MEO1/daemons:/etc/frr/daemons
      exec:
        - ip address add 193.101.0.254/2 dev e1
        - ip address add 193.101.0.1/2 dev e1_1
        - ip address add 193.101.0.2/2 dev e2_1
        - >-
          vtysh -c 'conf t'

          -c 'router ospf'

          -c 'network 192.0.0.0/2 area 0'

          -c 'exit'

          -c 'exit'

          -c 'write'

          -c '!'
    MEO2:
      kind: linux
      image: frrouting/frr:v8.2.2
      binds:
        - sat_output/MEO2/daemons:/etc/frr/daemons
      exec:
        - ip address add 193.102.0.254/2 dev e2
        - ip address add 193.102.0.1/2 dev e1_1
        - ip address add 193.102.0.2/2 dev e2_1
        - >-
          vtysh -c 'conf t'

          -c 'router ospf'

          -c 'network 192.0.0.0/2 area 0'

          -c 'exit'

          -c 'exit'

          -c 'write'

          -c '!'
    LEO1_1:
      kind: linux
      image: frrouting/frr:v8.2.2
      binds:
        - sat_output/LEO1_1/daemons:/etc/frr/daemons
      exec:
        - ip address add 193.101.1.1/2 dev e1_1
        - >-
          vtysh -c 'conf t'

          -c 'router ospf'

          -c 'network 192.0.0.0/2 area 0'

          -c 'exit'

          -c 'exit'

          -c 'write'

          -c '!'
    LEO1_2:
      kind: linux
      image: frrouting/frr:v8.2.2
      binds:
        - sat_output/LEO1_2/daemons:/etc/frr/daemons
      exec:
        - ip address add 193.101.2.1/2 dev e2_1
        - >-
          vtysh -c 'conf t'

          -c 'router ospf'

          -c 'network 192.0.0.0/2 area 0'

          -c 'exit'

          -c 'exit'

          -c 'write'

          -c '!'
    LEO2_1:
      kind: linux
      image: frrouting/frr:v8.2.2
      binds:
        - sat_output/LEO2_1/daemons:/etc/frr/daemons
      exec:
        - ip address add 193.102.1.1/2 dev e1_1
        - >-
          vtysh -c 'conf t'

          -c 'router ospf'

          -c 'network 192.0.0.0/2 area 0'

          -c 'exit'

          -c 'exit'

          -c 'write'

          -c '!'
    LEO2_2:
      kind: linux
      image: frrouting/frr:v8.2.2
      binds:
        - sat_output/LEO2_2/daemons:/etc/frr/daemons
      exec:
        - ip address add 193.102.2.1/2 dev e2_1
        - >-
          vtysh -c 'conf t'

          -c 'router ospf'

          -c 'network 192.0.0.0/2 area 0'

          -c 'exit'

          -c 'exit'

          -c 'write'

          -c '!'
  links:
    - endpoints:
        - MEO1:e1_1
        - LEO1_1:e1_1
    - endpoints:
        - MEO1:e2_1
        - LEO1_2:e2_1
    - endpoints:
        - MEO2:e1_1
        - LEO2_1:e1_1
    - endpoints:
        - MEO2:e2_1
        - LEO2_2:e2_1
    - endpoints:
        - GROUND:e1
        - MEO1:e1
    - endpoints:
        - GROUND:e2
        - MEO2:e2
